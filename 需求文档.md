# 																	需求分析

#### 注册

- 图形验证码
- 短信验证码
- 注册完自动登陆并跳转



#### 登陆

- 忘记密码

- 第三方登陆（QQ、支付宝等）

  

#### 个人信息

- 浏览记录
- 地址信息
- 修改密码
- 个人订单



#### 商品信息

- 分类、多级分类

- 详情

- 首页广告

- 搜索

  

#### 购物车

- 未登录保持商品信息
- 购物车合并提交
- 自动计算优惠价格



#### 订单

- 收货地址
- 支付方式选择
- 订单评价



### 5.支付	

- 支付宝、微信支付

  

  # 																项目架构

- 采用前后端分离的应用模式

- 前端使用Bootstrap与Vue.js

- 后端使用Django REST framework

- 数据库使用Mysql数据库，采用redis做数据缓存



# 								数据库表设计



### 用户模型类

由于Django认证系统中提供了用户模型类User，默认的User包含以下常见的基本字段：

- `username`： 用户名，可以包含字母数字，`_`，`@`，`+` `.` 和`-`字符，150个字符以内。 
- `first_name`：可选（`blank=True`）。 少于等于30个字符。
- `last_name`：可选（`blank=True`）。 少于等于30个字符。
- `email`：可选（`blank=True`）。 邮箱地址。
- `password`：密码的哈希及元数据。（Django 不保存原始密码）。原始密码可以无限长而且可以包含任意字符。
- `groups`：分组，与`Group` 之间的多对多关系。
- `user_permissions`：用户权限，与`Permission` 之间的多对多关系。
- `is_staff`：布尔值。 用户是否可以访问Admin 站点。
- `is_active`：布尔值。用户账号是否激活。
- `is_superuser`：布尔值。用户拥有所有权限。
- `last_login`：用户最后一次登陆时间。
- `date_joined`：用户账号创建时间。

并且默认的User还有一些常用的方法便于我们管理用户

- `set_password`(*raw_password*)：设置用户的密码为给定的原始字符串，并负责密码的。 不会保存`User` 对象。当`None` 为`raw_password` 时，密码将设置为一个不可用的密码。
- `check_password`(*raw_password*)：如果给定的raw_password是用户的真实密码，则返回True，可以在校验用户密码时使用。

我们可以继承该用户模型类，并添加一个手机号字段即可



### 商品模型类

#### 商品分类

|  字段  |    类型    |           说明            |
| :----: | :--------: | :-----------------------: |
|  name  | CharField  | 商品分类名，max_length=50 |
| parent | ForeignKey |  父类商品分类名，自关联   |



#### 多级分类

|   字段   |     类型     |                说明                 |
| :------: | :----------: | :---------------------------------: |
| group_id | IntegerField |            商品所属组号             |
| category |  ForeignKey  |           商品分类，外键            |
|   url    |  CharField   | 多级分类所属页面链接，max_length=50 |
| sequence | IntegerField |            多级分类顺序             |



#### 品牌

|     字段     |    类型    |         说明          |
| :----------: | :--------: | :-------------------: |
|     name     | CharField  | 品牌名，max_length=20 |
|     logo     | ImageField |       品牌图片        |
| first_letter | CharField  |      品牌首字母       |



#### 商品SPU

|   字段    |     类型     |         说明         |
| :-------: | :----------: | :------------------: |
|   name    |  CharField   | SPU名，max_length=50 |
|   brand   |  ForeignKey  |    商品品牌，外键    |
| category1 |  ForeignKey  |    一级分类，外键    |
| category2 |  ForeignKey  |    二级分类，外键    |
| category3 |  ForeignKey  |    三级分类，外键    |
|   sales   | IntegerField |   销量，default=0    |
| comments  | IntegerField |  评论数，default=0   |



#### 商品规格

| 字段  |    类型    |          说明           |
| :---: | :--------: | :---------------------: |
| goods | ForeignKey |       商品，外键        |
| name  | CharField  | 规格名称，max_length=20 |



#### 规格选项

| 字段  |    类型    |         说明          |
| :---: | :--------: | :-------------------: |
| spec  | ForeignKey |      规格，外键       |
| value | CharField  | 选项值，max_length=20 |



#### 商品SKU

|       字段        |     类型     |                             说明                             |
| :---------------: | :----------: | :----------------------------------------------------------: |
|       name        |  CharField   |                  商品SKU名称，max_length=50                  |
|      caption      |  CharField   |                    副标题，max_length=100                    |
|       goods       |  ForeignKey  |                          商品，外键                          |
|     category      |  ForeignKey  |                          类别，外键                          |
|       price       | DecimalField |            单价，max_digits=10, decimal_places=2             |
|    cost_price     | DecimalField |            进价，max_digits=10, decimal_places=2             |
|   market_price    | DecimalField |           市场价，max_digits=10, decimal_places=2            |
|       stock       | IntegerField |                       库存，default=0                        |
|       sales       | IntegerField |                       销量，default=0                        |
|     comments      | IntegerField |                      评价数，default=0                       |
|    is_launched    | BooleanField |                  是否上架销售，default=True                  |
| default_image_url |  CharField   | 图片，max_length=200, default='', <br />null=True, blank=True |



#### SKU图片

| 字段  |    类型    |     说明      |
| :---: | :--------: | :-----------: |
|  sku  | ForeignKey | 商品SKU，外键 |
| image | ImageField |    SKU图片    |



#### SKU具体规格

|  字段  |    类型    |      说明      |
| :----: | :--------: | :------------: |
|  sku   | ForeignKey | 商品SKU，外键  |
|  spec  | ForeignKey | 规格名称，外键 |
| option | ForeignKey |  规格值，外键  |



#### 广告内容类别

| 字段 |   类型    |          说明           |
| :--: | :-------: | :---------------------: |
| name | CharField |   名称，max_length=50   |
| key  | CharField | 类别键名，max_length=50 |





#### 广告内容

|   字段   |     类型     |            说明             |
| :------: | :----------: | :-------------------------: |
| category |  ForeignKey  |         类别，外键          |
|  title   |  CharField   |    标题，max_length=100     |
|   url    |  CharField   |  内容链接，max_length=300   |
|  image   |  ImageField  | 图片，null=True, blank=True |
|   text   |  TextField   | 内容，null=True, blank=True |
| sequence | IntegerField |            排序             |
|  status  | BooleanField |          是否展示           |



### 订单模型类

#### 订单信息

|     字段     |        类         |                    说明                     |
| :----------: | :---------------: | :-----------------------------------------: |
|   order_id   |     CharField     |         订单号，max_length=64，主键         |
|     user     |    ForeignKey     |               下单用户，外键                |
|   address    |    ForeignKey     |               收货地址，外键                |
| total_count  |   IntegerField    |                  商品总数                   |
| total_amount |   DecimalField    | 商品总金额，max_digits=10, decimal_places=2 |
|   freight    |   DecimalField    |    运费，max_digits=10, decimal_places=2    |
|  pay_method  | SmallIntegerField |                  支付方式                   |
|    status    | SmallIntegerField |                  订单状态                   |

```
支付方式 = {
		(1，"银行卡支付"),
		(2,“支付宝”)
				}
订单状态 = (
        (1, "待支付"),
        (2, "待发货"),
        (3, "待收货"),
        (4, "待评价"),
        (5, "已完成"),
        (6, "已取消"),
    )
```

​	

#### 订单商品

|     字段     |       类型        |                 说明                  |
| :----------: | :---------------: | :-----------------------------------: |
|    order     |    ForeignKey     |              订单，外键               |
|     sku      |    ForeignKey     |            订单商品，外键             |
|    count     |   IntegerField    |                 数量                  |
|    price     |   DecimalField    | 单价，max_digits=10, decimal_places=2 |
|   comment    |     TextField     |               评价信息                |
|    score     | SmallIntegerField |              满意度评分               |
| is_anonymous |   BooleanField    |             是否匿名评价              |
| is_commented |   BooleanField    |               是否评价                |

